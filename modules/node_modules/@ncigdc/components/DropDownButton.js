// @flow

import React from 'react';

import Button from '@ncigdc/uikit/Button';
import withDropdown from '@ncigdc/uikit/withDropdown';
import Column from '@ncigdc/uikit/Flex/Column';
import Row from '@ncigdc/uikit/Flex/Row';
import Tooltip from '@ncigdc/uikit/Tooltip';

import { dropdown, visualizingButton } from '@ncigdc/theme/mixins';
import { withTheme } from '@ncigdc/theme';

const styles = {
  row: theme => ({
    padding: '0.6rem 1rem',
    cursor: 'pointer',
    ':hover': {
      backgroundColor: theme.greyScale6,
    },
  }),
};

const DropDownButton = ({
  active,
  setActive,
  mouseDownHandler,
  mouseUpHandler,
  style,
  icon,
  label,
  options = [],
  disabled,
  tooltipHTML,
  theme
}) => {
  const button = (
    <Button
      style={visualizingButton}
      onClick={() => setActive(!active)}
      leftIcon={icon}
      disabled={disabled || !options.length}
    >
      {label}
    </Button>
  );

  return (
    <span
      style={{
        position: 'relative',
        ...style,
      }}
      onMouseDown={mouseDownHandler}
      onMouseUp={mouseUpHandler}
    >
      {tooltipHTML ? <Tooltip innerHTML={tooltipHTML}>{button}</Tooltip> : button}
      {active &&
        <Column style={dropdown} >
          {options.map(option => (
            <Row
              key={option.key || option.text}
              style={styles.row(theme)}
              onClick={() => {
                setActive(false);
                option.onClick();
              }}
            >{option.text}</Row>
          ))}
        </Column>
      }
    </span>
  );
};

export default withTheme(withDropdown(DropDownButton));
