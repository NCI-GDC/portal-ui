// @flow
import React from 'react';
import { withRouter } from 'react-router-dom';
import { stringify } from 'query-string';

const withBetterRouter = Wrapped => withRouter(({ push, ...props }) => {
  const betterPush = opts => {
    if (typeof opts === 'object') {
      push({
        pathname: opts.pathname,
        search: `?${stringify(opts.query)}`,
        state: opts.state,
      });
    } else push(opts);
  };

  return <Wrapped push={betterPush} {...props} />;
});

export default withBetterRouter;
