/* Copyright (c) 2007 Lev Muchnik <LevMuchnik@gmail.com>. All rights reserved.
 * You may copy and modify this script as long as the above copyright notice,
 * this condition and the following disclaimer is left intact.
 * This software is provided by the author "AS IS" and no warranties are
 * implied, including fitness for a particular purpose. In no event shall
 * the author be liable for any damages arising in any way out of the use
 * of this software, even if advised of the possibility of such damage.
 * $Date: 2007-10-03 19:08:15 -0700 (Wed, 03 Oct 2007) $
 */

function LoadXML(a,b){var c=GetParentElement(a);return null==c?!1:(ToggleElementVisibility(c),RequestURL(b,URLReceiveCallback,a))}function LoadXMLDom(a,b){if(b){var c=GetParentElement(a);if(null==c)return!1;for(;c.childNodes.length;)c.removeChild(c.childNodes.item(c.childNodes.length-1));var d=ShowXML(c,b.documentElement,0);return d}return!1}function LoadXMLString(a,b){xmlDoc=CreateXMLDOM(b),LoadXMLDom(a,xmlDoc),ToggleSubElements(document.getElementById("div_empty_1"),!1),ToggleElementVisibility(document.getElementById("div_empty_1"))}function GetParentElement(a){return"string"==typeof a?document.getElementById(a):"object"==typeof a?a:null}function URLReceiveCallback(a,b){try{if(4==a.readyState){if(200!=a.status)return!1;var c=a.responseXML;if(b&&null!=b)return b.innerHTML="",LoadXMLDom(b,c)}}catch(d){return!1}}function RequestURL(a,b,c){var d;if(window.XMLHttpRequest)d=new XMLHttpRequest,d.overrideMimeType&&d.overrideMimeType("text/xml");else if(window.ActiveXObject)try{d=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}return d?(d.onreadystatechange=function(){b(d,c)},d.open("GET",a,!0),d.send(""),!0):!1}function CreateXMLDOM(a){if(window.ActiveXObject)return xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.loadXML(a),xmlDoc;if(document.implementation&&document.implementation.createDocument){var b=new DOMParser;return b.parseFromString(a,"text/xml")}return null}function ShowXML(a,b,c){if(null==b||null==a)return!1;var d=!0,e=document.createElement("div");e.className="Element",e.style.position="relative",e.style.left=NestingIndent+"px";var f=document.createElement("div");if(f.className="Element",f.style.position="relative",f.style.left=NestingIndent+"px",0==b.childNodes.length)AddNodeNameWithAttributes(e,b),CloseElement(e," />"),a.appendChild(e);else if(1==b.childNodes.length&&"#text"==b.childNodes.item(0).nodeName){AddNodeNameWithAttributes(f,b),CloseElement(f,">");var g=b.childNodes.item(h).nodeValue;g&&AddTextNode(f,g,"NodeValue"),AddClosingElement(f,b.nodeName),a.appendChild(f)}else{AddClickablePlus(e,IDCounter),AddNodeNameWithAttributes(e,b),CloseElement(e,">"),AddClosingElement(e,b.nodeName),a.appendChild(e),SetVisibility(e,!1),AddClickableMinus(f,IDCounter),++IDCounter,AddNodeNameWithAttributes(f,b),CloseElement(f,">"),f.appendChild(document.createElement("br")),g=null;for(var h=0;b.childNodes&&h<b.childNodes.length;++h)"#text"!=b.childNodes.item(h).nodeName?d&=ShowXML(f,b.childNodes.item(h),c+1):g=b.childNodes.item(h).nodeValue;b.nodeValue&&(g=b.nodeValue),g&&AddTextInDiv(f,g),AddClosingElement(f,b.nodeName),a.appendChild(f)}return d}function CloseElement(a,b){AddTextNode(a,b)}function AddClosingElement(a,b){AddTextNode(a," </","Utility"),AddTextNode(a,b,"NodeName"),AddTextNode(a,">","Utility")}function AddNodeNameWithAttributes(a,b){AddTextNode(a,"<","Utility"),AddTextNode(a,b.nodeName,"NodeName");for(var c=0;b.attributes&&c<b.attributes.length;++c){var d=b.attributes.item(c);AddTextNode(a," "+d.nodeName,"AttributeName"),AddTextNode(a,"=","Utility"),AddTextNode(a,'"'+d.nodeValue+'"',"AttributeValue")}}function AddClickablePlus(a,b){var c=AddTextNode(a,"","Clickable element-expand");c.onclick=function(){ToggleElementVisibility(this)},c.id="div_empty_"+b,c.title="Expand";var d=AddTextNode(a,"","Clickable element-expand-all");d.title="Expand all",d.onclick=function(){c.click(),ToggleSubElements(c,!0)}}function AddClickableMinus(a,b){var c=AddTextNode(a,"","Clickable element-collapse");c.onclick=function(){ToggleElementVisibility(this)},c.id="div_content_"+b,c.title="Collapse";var d=AddTextNode(a,"","Clickable element-collapse-all");d.title="Collapse all",d.onclick=function(){c.click(),ToggleSubElements(c,!1)}}function ToggleSubElements(a,b){if(a&&a.id){try{ElementID=parseInt(a.id.slice(a.id.lastIndexOf("_")+1))}catch(c){return}var d="";d="div_content_"+ElementID,d=CompatibleGetElementByID(d);for(var e=d.parentNode.querySelectorAll(".Clickable"),f=e.length,g=null,h=0;f>h;h++)g=e[h],b?-1!=g.className.indexOf("element-expand")&&-1==g.className.indexOf("element-expand-all")&&"none"!=g.style.display&&g.click():-1!=g.className.indexOf("element-collapse")&&-1==g.className.indexOf("element-collapse-all")&&"none"!=g.style.display&&g.click()}}function AddTextInDiv(a,b){var c=document.createElement("div");c.style.position="relative",c.style.left=NestingIndent+"px",AddTextNode(c,b,"NodeValue"),a.appendChild(c)}function AddTextNode(a,b,c){return NewNode=document.createElement("span"),c&&(NewNode.className=c),b&&NewNode.appendChild(document.createTextNode(b)),a&&a.appendChild(NewNode),NewNode}function CompatibleGetElementByID(a){return a?document.getElementById?document.getElementById(a):document.layers?document.id:document.all.id:null}function SetVisibility(a,b){if(a){var c=b?"block":"none";document.getElementById?a.style.display=c:document.layers?a.display=c:a.id.style.display=c}}function ToggleElementVisibility(a){if(a&&a.id){try{ElementType=a.id.slice(0,a.id.lastIndexOf("_")+1),ElementID=parseInt(a.id.slice(a.id.lastIndexOf("_")+1))}catch(b){return}var c=null,d=null;"div_content_"==ElementType?(c="div_content_"+ElementID,d="div_empty_"+ElementID):"div_empty_"==ElementType&&(d="div_content_"+ElementID,c="div_empty_"+ElementID),c=CompatibleGetElementByID(c),d=CompatibleGetElementByID(d),c&&(c=c.parentNode),d&&(d=d.parentNode),SetVisibility(c,!1),SetVisibility(d,!0)}}var IDCounter=1,NestingIndent=15;